%!TEX root = ../thesis.tex
% ******************************* Thesis Appendix C ****************************
\cleardoublepage
\chapter{Rare event estimation algorithm}
\label{apx:C}
%*******************************************************************************


%============================================================%
%============================================================%
\section*{Subset simulation (SS)}
%============================================================%
%============================================================%
The next algorithm describes the subset simulation methods introduced by \citet{AuBeck2001}. 

\begin{algorithm}[h]
    \caption{Subset simulation (SS).}\label{alg:ss}
    \footnotesize
    \begin{algorithmic}
        \State \Comment{\textbf{Inputs:}}\hfill~
        \State $f_\bX$, joint PDF of the inputs
        \State $g(\cdot)$, LSF
        \State $\yth \in \R$, threshold defining the failure event 
        \State $N$, number of samples per iteration
        \State $m \in \N$, parameter of the EBC fitting
        \State $p_0 \in \left]0, 1\right[$, empirical quantile order (rarity parameter)
        \State \Comment{\textbf{Algorithm:}}\hfill~
        \State Set $k = 0$ and $f_{[0]} = f_\bX$
        \State Sample $\bX_{[0], N} = \{\bX_{[0]}^{(j)}\}_{j=1}^N \overset{\text{i.i.d}}{\sim} f_{[0]}$
        \State Evaluate $G_{[0], N} = \{g(\bX_{[0]}^{(j)})\}_{j=1}^N$
        \State Estimate the empirical $p_0$-quantile $\widehat{q}_{[0]}^{\, p_0}$ of the set $G_{[0], N}$
        
        \While{$\widehat{q}_{[k]}^{\, p_0} > \yth$}
        \State Subsample $\mathbf{A}_{[k+1], n}=\{\bX_{[k]}^{(j)} \subset \bX_{[k], N}| g(\bX_{[k]}^{(j)}) > \widehat{q}_{[k]}^{\, p_0} \}_{j=1}^n$
        \State Fit marginals of the subset $\mathbf{A}_{[k+1], n}$ by KDE $\{\widehat{F}_i\}_{i=1}^d$
        \State Fit the copula of the subset $\mathbf{A}_{[k+1], n}$ by EBC $B_\bm(C_n)$
        \State Build a CDF $\widehat{F}_{[k+1]}(\bx) = B_\bm(C_n)(\widehat{F}_1(x_1), \dots, \widehat{F}_d(x_d))$
        \State Sample $\bX_{[k+1], N} = \{\bX_{[k+1]}^{(j)}\}_{j=1}^N \overset{\text{i.i.d}}{\sim} \widehat{f}_{[k+1]}$
        \State Sample by MCMC $\bX_{[k+1], N} \!=\! \{\bX_{[k+1]}^{(j)}\}_{j=1}^N \!\overset{\text{i.d}}{\sim}\! f_{\bX | F_{[k+1]}}$ (with $\mathbf{A}_{[k+1], n}$ as initialization points)
        \State Evaluate $G_{[k+1], N} = \{g(\bX_{[k+1]}^{(j)})\}_{j=1}^N$
        \State Estimate the empirical $p_0$-quantile $\widehat{q}_{[k+1]}^{\, p_0}$ of $G_{[k+1], N}$
        \State Set $k = k+1$
        \EndWhile
        \State Set total iteration number $k_\# = k-1$ 
        \State Estimate $\widehat{\pf} = (1 - p_0)^{k_\#} \cdot \frac{1}{N} \sum_{j=1}^N \1_{\{g(\bX_{[k_\#]}^{(j)}) \geq \yth  \}}(\bX_{[k_\#]^{(j)}}) $
        \State \Comment{\textbf{Outputs:}}\hfill~
        \State $\widehat{\pf}$, estimate of $\pf$
    \end{algorithmic}
    \end{algorithm}
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%============================================================%
%============================================================%
%\section*{Nonparametric adaptive importance sampling (NAIS)}
%============================================================%
%============================================================%










